<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 20px; background: white; }
        .top-bar { display: flex; justify-content: space-between; margin-bottom: 20px; }
        #searchBox { padding: 10px; width: 60%; border: 1px solid #ddd; border-radius: 5px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { background: #34495e; color: white; padding: 12px; text-align: left; }
        td { padding: 12px; border-bottom: 1px solid #eee; }
        tr:hover { background: #f9f9f9; }
        .btn { padding: 5px 10px; cursor: pointer; border: none; border-radius: 3px; margin-right: 5px; }
        .btn-print { background: #3498db; color: white; }
        .btn-edit { background: #f39c12; color: white; }
    </style>
</head>
<body>

    <div class="top-bar">
        <input type="text" id="searchBox" placeholder="Search by Client or Invoice ID..." onkeyup="filterTable()">
        <button onclick="loadInvoices()" style="padding: 10px;">Refresh List</button>
    </div>

    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Invoice ID</th>
                <th>Client Name</th>
                <th>Total Amount</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="invoiceTableBody">
            </tbody>
    </table>

    <script>
        const API_URL = "YOUR_GAS_URL_HERE";
        const user = JSON.parse(localStorage.getItem("user"));

        window.onload = loadInvoices;

        async function loadInvoices() {
            const tbody = document.getElementById("invoiceTableBody");
            tbody.innerHTML = "<tr><td colspan='5'>Loading invoices...</td></tr>";

            try {
                const response = await fetch(`${API_URL}?action=getInvoices&userId=${user.id}`);
                const data = await response.json();
                
                tbody.innerHTML = "";
                data.forEach(inv => {
                    const tr = document.createElement("tr");
                    tr.innerHTML = `
                        <td>${inv.date}</td>
                        <td>${inv.invoiceId}</td>
                        <td>${inv.clientName}</td>
                        <td>$${parseFloat(inv.total).toFixed(2)}</td>
                        <td>
                            <button class="btn btn-print" onclick="printInvoice('${inv.invoiceId}')">Print</button>
                            <button class="btn btn-edit" onclick="editInvoice('${inv.invoiceId}')">Edit</button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
            } catch (err) {
                tbody.innerHTML = "<tr><td colspan='5'>Error loading data.</td></tr>";
            }
        }

        function filterTable() {
            const query = document.getElementById("searchBox").value.toLowerCase();
            const rows = document.querySelectorAll("#invoiceTableBody tr");
            
            rows.forEach(row => {
                const text = row.innerText.toLowerCase();
                row.style.display = text.includes(query) ? "" : "none";
            });
        }

        function printInvoice(id) {
            alert("Printing functionality for " + id + " will be added in the next step!");
        }

        function editInvoice(id) {
            alert("Edit mode for " + id + " coming soon!");
        }
    </script>
</body>
</html>
